#import "../fragments/PriceRange.graphql"

query Products(
    $search: String = ""
    $filter: ProductAttributeFilterInput
    $withAggregations: Boolean = false
    $withItems: Boolean = true
    $sort: ProductAttributeSortInput
    $currentPage: Int = 1
) {
    products(
        search: $search
        filter: $filter
        sort: $sort
        currentPage: $currentPage
    ) {
        aggregations @include(if: $withAggregations) {
            attributeCode: attribute_code
            label
            options {
                label
                value
            }
        }

        maxPrice: max_price @include(if: $withAggregations)

        minPrice: min_price @include(if: $withAggregations)

        pageInfo: page_info {
            currentPage: current_page
            pageSize: page_size
            totalPages: total_pages
        }

        sortFields: sort_fields @include(if: $withAggregations) {
            default
            options {
                label
                value
            }
        }

        totalCount: total_count

        items @include(if: $withItems) {
            id

            # Custom Product Fields
            isInCompare @client
            isInCart @client
            isInWishlist @client
            isExistSubscription @client
            isExistReviews @client
            # /Custom Product Fields

            sku

            acRfTransceiver: ac_rf_transceiver
            acLoraClass: ac_lora_class
            acOtherProtocol: ac_other_protocol

            urlKey: url_key
            urlRewrites: url_rewrites {
                url
            }
            name
            commercialStatus: commercial_status
            commercialStatusText: commercial_status_text

            manufacturerName: manufacturer_name

            addToCartLabel: add_to_cart_label

            mediaGallery: media_gallery {
                url
                label
                position
                disabled
            }

            image {
                url
                label
            }
            reviewSummary: review_summary {
                ratingSummary: rating_summary
            }

            calculatedPrice @client
            priceBadges @client
            priceRange: price_range {
                ... PriceRangeFragment
            }

            categories {
                id
                name
                level
                categoryWidgetSvgIcon: category_widget_svg_icon
            }
        }
    }
}
