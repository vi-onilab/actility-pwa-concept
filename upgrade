#!/usr/bin/env node

const { spawn } = require('child_process')
const { readdirSync } = require('fs')
const { join } = require('path')

console.log('Installing PWA...')

const packages = readdirSync(join(__dirname, 'packages')).reduce((result, name) => {
	if (__dirname.startsWith(process.cwd())) {
		result.push(`portal:${join('.', __dirname.substring(0, process.cwd().length), 'packages', name)}`)
	} else {
		result.push(`portal:${join(__dirname, 'packages', name)}`)
	}

	return result
}, [])

spawn(`yarn`, ['add', ...packages], { stdio: 'inherit', cwd: process.cwd() })

console.log('Installed. Be happy!')
